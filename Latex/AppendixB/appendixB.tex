
\chapter{Decision Making with Analytical Hierarchy Process}
\label{appendix:DecisionMakingAHP}
\graphicspath{ {./appendixB/Fig} }

\begin{itquote}
Making good decisions is a crucial skill at every level.---Peter Drucker
\end{itquote}

A hallmark of design is that many decisions must be made throughout the
process. Typically, there are alternative solutions to a problem from
which the best one relative to some criteria is selected. This appendix
presents the Analytical Hierarchy Process (AHP) approach to decision
making. AHP is a flexible quantitative and qualitative method that is
applicable to many problems which provides a numerical score for the
alternatives considered. Different aspects of AHP are applied throughout
the text and this appendix is structured to teach AHP via example. A
summary of AHP is provided at the conclusion of the appendix.

To apply AHP there must be a decision to be made, criteria against which
the decision is based, and a set of competing decisions from which one
must be selected. This process is encapsulated in the decision matrix
shown in Table~\ref{table:abstractDecisionMatrix} and as such the process is sometimes referred to as
the \emph{\textbf{decision-matrix method}}. The row headings are the
criteria against which the decision is made and the column headings
represent the alternatives. The criteria can have differing levels of
importance and their relative weightings are reflected by
$\omega_{i}$ values in the matrix. The entries
in the matrix, $\alpha_{ij}$, are ratings for each $j$th alternative relative to
$i$th criterion. Each alternative receives a score, $S_{j}$, which is a weighted sum of the ratings
that is computed as

\begin{equation}
\label{equ:decisionMatrix}
S_{j} = \sum_{i=1}^{m} \omega_{i}\alpha{ij}
\end{equation}


\begin{table}[h]
\caption{A decision matrix.}
\label{table:abstractDecisionMatrix}

\begin{tabular}{|c|c|c|c|c|c|}
\hline
\rowcolor{Gray}
\multicolumn{2}{|c|}{} & \textbf{Alternative 1}  & \textbf{Alternative 2} &   & \textbf{Alternative n} \\ \hline
\textbf{Criteria 1} & $\omega_{1}$ & $\alpha_{11}$ & $\alpha_{12}$ & $\hdots$ & $\alpha_{m1}$ \\ \hline
\textbf{Criteria 2} & $\omega_{2}$ & $\alpha_{11}$ & $\alpha_{22}$ & $\hdots$ & $\alpha_{m2}$ \\ \hline
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\hdots$ & $\vdots$ \\ \hline
\textbf{Criteria m} & $\omega_{m}$ & $\alpha_{1n}$ & $\alpha_{2n}$ & $\hdots$ & $\alpha_{mn}$ \\ \hline
\multicolumn{2}{|c|} {\textbf{Score}} & 
			$S_{1} = \sum_{i=1}^{m}\omega_{i}\alpha_{i1}$  & 
			$S_{2} = \sum_{i=1}^{m}\omega_{i}\alpha_{i2}$  & 
			$\hdots$ & 
			$S_{n} = \sum_{i=1}^{m}\omega_{i}\alpha_{im}$    \\ \hline
\end{tabular}
\end{table}

The steps of AHP are to:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Determine the selection criteria.
\item
  Determine the criteria weightings.
\item
  Identify and rate alternatives relative to the criteria.
\item
  Compute scores for the alternatives.
\item
  Review the decision.
\end{enumerate}

AHP is demonstrated through two examples in which the decision to
purchase a car is considered. This example has the benefit of being
relatively easy to understand, has readily available public data for
supporting the decision, demonstrates the principles of AHP clearly, and
is extensible to design problems. The first example demonstrates a
straightforward set of criteria, while the second extends to
hierarchical criteria.

\section{Applying AHP for Car Selection}
\label{section:applying-ahp-for-car-selection}

AHP is demonstrated in this section by examining the decision to
purchase an automobile.

\subsection*{Step 1: Determine the Selection Criteria}

The first step is to brainstorm to identify the criteria against which
the decision is made -- ideally it is done prior to identification of
the alternatives. The pitfall of identifying alternatives first is that
the criteria may be selected to bias towards a particular alternative.
Assume that the criteria determined are:

\begin{itemize}
\item
  Purchase cost
\item
  Safety
\item
  Design styling
\item
  Brand-name recognition
\end{itemize}

\subsection*{Step 2: Determine the Criteria Weightings}

To determine the weights, $\omega_{ij}$,
a method known as \emph{\textbf{pairwise comparison}} is applied, where
each criterion is systematically compared to all others. For example,
the purchase cost is compared to safety, design, and brand-name.
Likewise, safety is compared to the remaining criteria and so on. A
common practice in AHP to apply the following scale for pairwise
comparison and it is used throughout the book for consistency
\begin{center}
1 = equal, 3 = moderate, 5 = strong, 7 = very strong, 9 = extreme.
\end{center}
For example, if one criterion is deemed strongly more important than
another, it is assigned a score of `5', while if it is deemed strongly
less important, it is assigned the reciprocal value `1/5'.

Example comparisons are captured in the comparison matrix in 
Table~\ref{table:pairwiseCompareSelection}.
For each cell, the corresponding row criterion is compared to the column
criterion. From the first row of the table it is apparent that purchase
cost is considered of equal importance to safety, moderately more
important than design, and very strongly more important than brand-name.
By definition, the diagonal elements are assigned values of 1 since each
is equally important to itself. The matrix should have the following
relationship about the diagonal, $x_{ij} = 1/x_{ji}$.


\begin{table}[h]
\caption{Pairwise comparison of the selection criteria.}
\label{table:pairwiseCompareSelection}

\begin{tabular}{|c|c|c|c|c|}
\hline
\rowcolor{Gray}
			 & \textbf{Purchase cost}  & \textbf{Safety} & \textbf{Design} & \textbf{Brand name} \\ \hline
\textbf{Purchase cost} & 1 & 1 & 3 & 7 \\ \hline
\textbf{Safety} & 1 & 1 & 5 & 9 \\ \hline
\textbf{Design} & 1/3 & 1/5 & 1 & 3 \\ \hline
\textbf{Brand-name} & 1/7 & 1/9 & 1/3 & 1 \\ \hline
\end{tabular}
\end{table}

People often make comparisons that are inconsistent. Look at the first
row -- purchase cost and safety are deemed to be equally important,
while cost is moderately more important than design (factor of 3). Yet,
in the second row safety is seen as strongly more important than design
(by a factor of 5). This is inconsistent, since if we are to believe the
first row, then safety would be only moderately more important than
design (by a factor of 3) -- just as the purchase cost was compared
relative to safety in the first row.

An intuitive approach for computing the weight for each criterion is to
sum each row. Since a given row represents the comparison of a single
criterion to all others -- the larger a row sum is the more important it
is and the higher the weight it achieves. However, the problem of
inconsistency needs to be addressed. There are a number of approaches
that can be shown mathematically to reduce the inconsistency in the
matrix. A simple method is to take the geometric mean of each row. The
geometric mean of a series of numbers, $a_{1}, a_{2}, \hdots a_{n}$
, is computed as

\begin{equation}
\label{equ:geometricMean}
Geometric mean = \sqrt[n]{a_{1} a_{2}, \hdots a_{n}}.
\end{equation}

The geometric mean is often used to reduce bias in skewed data. 
Table~\ref{table:weightedValuesFromPairwiseCompareSelection}
 demonstrates how the weights are computed. First, the geometric mean
of each row is computed and then the sum of the geometric means is
found. The mean values are divided by the sum to produce a normalized
set of weights; that is,

$$\sum_{i} \omega_{i} = 1.$$

No matter what
method is applied to find the weights, they should be normalized to a
sum of one.

\begin{table}[h]
\caption{Weight values computed from the pairwise comparison.}
\label{table:weightedValuesFromPairwiseCompareSelection}

\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
\rowcolor{Gray}
			 & \textbf{Purchase cost}  & \textbf{Safety} & \textbf{Design} & \textbf{Brand name} & {Geometric Mean} & {Weights}\\ \hline
\textbf{Purchase cost} & 1 & 1 & 3 & 7 & 2.1 & 0.37 \\ \hline
\textbf{Safety} & 1 & 1 & 5 & 9 & 2.6 & 0.46 \\ \hline
\textbf{Design} & 1/3 & 1/5 & 1 & 3 & 0.7 & 0.12 \\ \hline
\textbf{Brand-name} & 1/7 & 1/9 & 1/3 & 1 & 0.3 & 0.05 \\ \hline
\end{tabular}
\end{table}


The criteria have the following weights
$\omega_{1} =0.37$,
$\omega_{1} =0.46$,
$\omega_{1} =0.12$, and
$\omega_{1} =0.05$. These calculations are
easily automated with spreadsheet software.

\subsection*{Step 3: Identify and Rate Alternatives Relative to the Criteria}


The three competing alternatives to be evaluated are the 2006 model year
Honda CR-V, Hyundai Tucson, and Toyota RAV4, which are all small
sport-utility vehicles. The ratings of each alternative relative to each
criterion, $\alpha_{ij}$, that make up the body
of the decision matrix are determined next. Ideally, quantitative
ratings are determined, but in many cases it is necessary to use a more
qualitative approach. Higher ratings should reflect a better match to
the criteria. Creativity and ingenuity are often needed to determine a
proper metric.

Let's examine purchase cost. The vehicle costs are \$21,026 (Honda),
\$18,183 (Hyundai), and \$21,989 (Toyota). The purchase cost itself
cannot be used directly for a rating metric, since the highest cost
would achieve the highest rating, whereas the objective is to minimize
cost and reward the lowest cost with the highest rating. An alternative
metric is needed. A metric that works when the objective is to minimize
a criterion is to compare it to the minimum of all values using the
following ratio

\begin{equation}
\label{equ:costRatio}
\alpha = \frac{min[cost]}{cost}
\end{equation}

This assigns a maximum value of 1 to the lowest cost option, which in
this case is the Hyundai. The cost ratings are computed to be
$\alpha{11} = 0.86$,
$\alpha{12} =  1$, and
$\alpha{13} =  0.83$. It is important that the
ratings relative to each criteria be normalized so that their sum is
one. If not, the sum of ratings for each criterion will be different.
This would introduce bias by altering the relative weights of the
criteria. The normalized ratings are
$\alpha{11} =  0.32$,
$\alpha{12} =  0.37$, and
$\alpha{13} =  0.31$.

Next, a metric for safety is needed. Fortunately, there is real data to
draw upon from the US National Highway Transportation Safety Association
(\href{http://www.safercar.gov}{www.safercar.gov}) which rates vehicles
in multiple categories on a five-point scale. The average rating for
each car is 
$\alpha{21} =  4.8$ (Honda),
$\alpha{22} =4.8$ (Hyundai), and
$\alpha{23} = 4.6$ (Toyota), 
producing the following normalized values 
$\alpha{21} = 0.34$, 
$\alpha{21} = 0.34$, and
$\alpha{21} = 0.32$.

The rating of the cars relative to the design styling criterion is
considered next. This requires a more subjective approach than the
previous two criteria. To quantify the subjective evaluation pairwise
comparison is again applied to determine the relative value of one
automobile's design to another. Pairwise comparison for the design
styling criteria is shown in Table~\ref{table:pairwiseCompareDesignRatings}. 
The 2006 CR-V is has older styling, resulting in a much lower design
styling rating than the others.



\begin{table}[h]
\caption{Pairwise comparison of design styling to determine ratings.}
\label{table:pairwiseCompareDesignRatings}

\begin{tabular}{|c|c|c|c|c|}
\hline
\rowcolor{Gray}
			 & \textbf{Honda CRV}  & \textbf{Hyundai Tucson} & \textbf{Toyota RAV4} & \textbf{Design Rating}\\ \hline

\textbf{Honda CRV} 			& 1 & 1/3 & 1/5 & 0.11 \\ \hline
\textbf{Hyundai Tucson} 	& 3 & 1 & 1/2 & 0.31 \\ \hline
\textbf{Toyota RAV4}		& 5 & 2 & 1 & 0.58 \\ \hline
\end{tabular}
\end{table}

Finally, the ratings for brand-name recognition are determined using
pairwise comparison as shown in Table~\ref{table:pairwiseCompareNameRatings}.


\begin{table}[h]
\caption{Pairwise comparison of brand-name to determine ratings.}
\label{table:pairwiseCompareNameRatings}

\begin{tabular}{|c|c|c|c|c|}
\hline
\rowcolor{Gray}
			 & \textbf{Honda CRV}  & \textbf{Hyundai Tucson} & \textbf{Toyota RAV4} & \textbf{Design Rating}\\ \hline

\textbf{Honda CRV} 			& 1 & 4 & 1 & 0.44 \\ \hline
\textbf{Hyundai Tucson} 	& 1/4 & 1 & 1/4 & 0.12 \\ \hline
\textbf{Toyota RAV4}		& 1 & 4 & 1 & 0.44 \\ \hline
\end{tabular}
\end{table}


Note that the pairwise comparison method can be somewhat time-consuming
since many comparisons must be made. When making subjective estimates, a
faster approach is to use scoring rubric that reflects how well each of
the alternatives meet the criterion, for example

1 = does not meet criterion, 5 = partially meets criterion, 9 = completely meets criterion.

Keep in mind that pairwise comparison has the advantage of a systematic
comparison of alternatives and this reduces inconsistency in ratings.

\subsection*{Step 4: Compute Scores for the Alternatives}

The decision matrix is built and the overall weighted scores for the
alternatives are computed as shown in Table~\ref{table:decisionMatrix}.

\begin{table}[h]
\caption{The decision matrix.}
\label{table:decisionMatrix}

\begin{tabular}{|c|c|c|c|c|}
\hline
\rowcolor{Gray}
\multicolumn{2}{|c|}{}	 & \textbf{Honda CRV}  & \textbf{Hyundai Tucson} & \textbf{Toyota RAV4} \\ \hline
\textbf{Cost} & 0.37 & 0.32 & 0.37 & 0.31 \\ \hline
\textbf{Safety} & 0.46 & 0.34 & 0.34 & 0.32 \\ \hline
\textbf{Design styling} & 0.12 & 0.11 & 0.31 & 0.58 \\ \hline
\textbf{Brand-name} & 0.05 & 0.44 & 0.12 & 0.44 \\ \hline
\multicolumn{2}{|c|}{\textbf{Score}}	&  \textbf{0.31} & \textbf{0.34} & \textbf{0.35} \\ \hline
\end{tabular}
\end{table}

\subsubsection*{Step 5: Review the Decision}

The result is a set of numerical scores for the alternatives and if all
work is done properly the final scores should sum to one. In this case
there is not much difference between the scores and a simple decision
based upon the maximum value would lead to selection of the RAV4. Since
there is not much of a difference, all three are good choices based upon
the selection criteria. The decision matrix allows the examination of
different scenarios as the weights and ratings can be varied to see how
they affect the overall scores. The RAV4 beats the Tucson primarily due
to styling and brand-name, which are both subjective ratings. This might
warrant re-visiting those ratings to see how they impact the decision.
The RAV4 barely beats out the Tucson, so if cost and safety are truly
more important, the Tucson is a better decision as it beats the RAV4 in
both of those categories.

\section{Hierarchical Decision Criteria}
\label{section:hierarchical-decision-criteria}

The example in the previous section had fairly simple selection criteria
and it arguably missed some important ones, such as the operating costs.
Further, when considering operating cost it becomes apparent that it has
multiple dimensions, or sub-criteria, such as fuel and insurance costs.
Similarly, the design styling criterion can be sub-divided into interior
and exterior design. Thus there is a hierarchy in the criteria, giving
rise to the name Analytical Hierarchy Process. The following extends the
previous example to include the use of hierarchical criteria.

\subsection*{Step 1: Determine the Selection Criteria}

Assume that the criteria have been expanded to be more realistic as
shown below:

\begin{itemize}
\item   Purchase cost
\item   Operating costs

  \begin{itemize}
  \item     Fuel
  \item     Insurance
  \end{itemize}
\item   Safety
\item   Design styling

  \begin{itemize}
  \item     Interior
  \item     Exterior
  \end{itemize}
\item   Brand-name recognition
\end{itemize}

\subsubsection*{Step 2: Determine the Criteria Weightings}

Pairwise comparison is again used to determine the weights. The
difference now is that this comparison is done at each level in the
hierarchy. First, purchase cost, operating costs, safety, design, and
brand-name recognition are compared. Then fuel and insurance costs are
compared to each other since they are at the same level and grouping in
the hierarchy, as are exterior and interior design. Assume that the
pairwise comparisons produce the following criteria weights:

\begin{itemize}
\item   Purchase cost (0.33)
\item   Operating Costs (0.11)

  \begin{itemize}
  \item    MPG (0.67)
  \item    Insurance (0.33)
  \end{itemize}
\item  Safety (0.40)
\item  Design Styling (0.12)

  \begin{itemize}
  \item    Interior (0.50)
  \item    Exterior (0.50)
  \end{itemize}
\item  Brand-name recognition (0.04)
\end{itemize}

\subsection*{Step 3: Identify and Rate Alternatives Relative to the Criteria}

Utilizing the results from the previous section, it is only necessary to
compute scores relative to the new criteria. Using mileage per gallon as
a metric for ratings fuel costs is straightforward, since the two are
directly proportional. This data is readily available and is 24, 23, and
25 miles per gallon for the CR-V, Tucson, and RAV4 respectively. This
produces normalized ratings of 0.33, 0.32, and 0.35 respectively.

In terms of insurance costs, the National Highway Transportation Safety
Institute publishes the relative average loss per insured vehicle, a
rating that is used by insurance companies to determine insurance costs.
A score of 100 is the industry average -- those exceeding 100 are above
the average and those less than 100 are below it. The publicly available
ratings are 93, 100, and 112 for the CR-V, Tucson, and RAV4
respectively. Again, the objective is to minimize these values so the
metric in equation (3) is used. This produces normalized ratings of
0.36, 0.34, and 0.30 respectively.

Styling is subjective and ratings could be determined using a scoring
rubric or the pairwise comparison method. Assume that this produces the
scores shown in Table~\ref{table:decisionMatrixCarPurchase}.

\subsection*{Step 4: Compute Scores for the Alternatives}

The decision-matrix shown in Table~\ref{table:decisionMatrixCarPurchase} reflects the hierarchical
criteria. The scores are computed slightly differently when sub-criteria
are involved. For example, the score for operating costs of the Honda is
computed based upon the two sub-criteria as (0.67x0.33 + 0.33x0.36) =
0.34. The value of 0.34 is then the rating reflected in table for the
operating costs of this vehicle. Then to get the weighted score for
operating costs, this result of 0.33 is multiplied by the weight of
0.11, exactly as in the previous example.


\begin{table}[h]
\caption{The decision matrix.}
\label{table:decisionMatrixCarPurchase}

\begin{tabular}{|l|c|c|c|c|}
\hline
\rowcolor{Gray}
\multicolumn{2}{|c|}{}	 & \textbf{Honda CRV}  & \textbf{Hyundai Tucson} & \textbf{Toyota RAV4} \\ \hline
\textbf{Purchase Cost} & 0.33 & 0.32 & 0.37 & 0.31 \\ \hline
\textbf{Operating Cost} & 0.11 & 0.34 & 0.32 & 0.33 \\ \hline
\hspace{1em}Fuel & 0.67 &0.33 &0.32 &0.35 \\ \hline
\hspace{1em}Insurance & 0.33 & 0.36 & 0.34 & 0.30 \\ \hline
\textbf{Safety} & 0.40 & 0.34 & 0.34 & 0.32 \\ \hline
\textbf{Design Styling} & 0.12 & 0.20 & 0.40 & 0.40 \\ \hline
\hspace{1em}Interior & 0.60& 0.20 & 0.40 & 0.40 \\ \hline
\hspace{1em}Exterior & 0.40 &  0.20 & 0.40& 0.40 \\ \hline
\textbf{Brand-name} & 0.04 & 0.44 & 0.12 & 0.44 \\ \hline
\multicolumn{2}{|c|}{Score} & 0.32 & 0.35 & 0.33 \\ \hline
\end{tabular}
\end{table}

\subsection*{Step 5: Review the Decision}

With this expanded set of criteria, there is a shift in the overall
ranking and the Hyundai Tucson edges out the Toyota RAV4. Frankly, all
three are good choices and reflects the highly competitive car market. A
comparison of vehicles across classes, such as sport-utility, mid-size,
and a luxury car would likely results in a much larger differential in
the scoring, based upon the weighted criteria used here.

\section{Summary and Further Reading}

The Analytical Hierarchy Process is an effective tool for comparing
competing alternatives that integrates both quantitative and qualitative
judgments. In order to compare alternatives, criteria for comparison are
selected and the relative weights of the criteria assigned. In terms of
selecting the criteria and their weightings, remember the following:

\begin{itemize}
\item
  Ideally, the criteria are selected prior to identification of the
  alternatives. This avoids the trap of selecting the criteria to
  support a pre-conceived decision.
\item
  There is no single correct way to compute the criterion weights.
  However, the pairwise comparison approach is well-accepted. It can be
  a bit time-consuming, particularly when a large number of criteria are
  to be compared. If used properly pairwise comparison reduces bias in
  the decision.
\item
  There are alternatives to pairwise comparison. One is to rank the
  criterion from most important to least important and then assign a
  relative weighting based upon the ranking. Another alternative is to
  utilize a rubric using a semi-qualitative scale, as 1= low importance,
  5 = medium importance, and 9 = extremely important.
\item
  Regardless of how the weights are selected, the sum of the weights
  should be normalized to a value of one.
\end{itemize}

Once the criteria and weights are found, ratings for each option
relative to the criteria are determined. When computing the ratings,
remember the following:

\begin{itemize}
\item
  If quantitative data is available it should be used. It is admittedly
  hard to determine for many problems.
\item
  Appropriate metrics need to be used for rating quantitative data.
\item
  If quantitative data is unavailable, qualitative judgments must be
  made and quantified. Again, the pairwise comparison is a good tool for
  quantifying such judgments. Alternatively, a rubric for rating the
  alternatives against the criteria can be used.
\item
  The ratings relative to each criterion need to be normalized so that
  their sum is equal to one.
\end{itemize}

The final result is a decision-matrix and scores for each of the
alternatives. This matrix allows one to see the quantify decisions
allowing a rationale approach to decision-making, minimizing emotional
factors in the decision

AHP was originally developed by Thomas Saaty {[}Sat88{]} and has found
wide acceptance since. There are software packages available, such as
Expert Choice, that allow for rapid comparison of alternatives and
evaluation
